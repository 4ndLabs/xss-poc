<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NBA iframe postMessage test</title>
</head>
<body>
  <h2>Testing postMessage to NBA iframe</h2>

  <iframe 
    id="targetIframe" 
    src="https://gamecenter.nba.com/nba-fankit-v1/production/index.html?h=cdn-us.monterosa.cloud&p=559f4abc-a54e-4c87-98f5-acba50aeb7bb&e=dc5b4dbb-73d5-4b53-a59c-184e46e12b67#/" 
    width="800" 
    height="600" 
    style="border:1px solid black;">
  </iframe>

  <script>
    const iframe = document.getElementById('targetIframe');

    window.addEventListener('message', function (e) {
      console.log('== Message Received ==');
      console.log('Origin:', e.origin);

      if (e.origin !== "https://gamecenter.nba.com") {
        console.warn("Unexpected origin:", e.origin);
        return;
      }

      console.log('Source:', e.source);
      console.log('Data:', JSON.stringify(e.data, null, 2));
    }, false);

    iframe.addEventListener('load', () => {
      const message = {
        __gppCall: {
          command: "getConsent",
          parameter: null,
          callId: "demo789"
        }
      };

      iframe.contentWindow.postMessage(message, 'https://gamecenter.nba.com');
    });
  </script>
</body>
</html>
